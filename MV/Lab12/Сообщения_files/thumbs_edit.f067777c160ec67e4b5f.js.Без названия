!function(t){function e(e){for(var a,o,s=e[0],l=e[1],h=e[2],c=0,u=[];c<s.length;c++)o=s[c],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);for(d&&d(e);u.length;)u.shift()();return r.push.apply(r,h||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],a=!0,s=1;s<i.length;s++){var l=i[s];0!==n[l]&&(a=!1)}a&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var a={},n={"web/thumbs_edit":0},r=[];function o(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=a,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(i,a,function(e){return t[e]}.bind(null,a));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/js/cmodules/";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var h=0;h<s.length;h++)e(s[h]);var d=l;r.push([265,"bundles/common"]),i()}({265:function(t,e,i){t.exports=i("n8lp")},n8lp:function(t,e,i){"use strict";i.r(e);i("rGqo"),i("rE2o"),i("ioFf"),i("HEwt"),i("SRfc"),i("a1Th"),i("Btvt");var a=i("/PiP"),n=i("jE6c");i("91GP"),i("KKXr");function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t}).apply(this,arguments)}function o(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],a=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){n=!0,r=t}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}!window.isMVK&&(window.vkExpand=window.vkExpand||"VK"+ +new Date,window.vkUUID=window.vkUUID||0,window.vkCache=window.vkCache||{});var l="doc",h="photo",d="video",c="album",u="market_album",v=window.isMVK?200:120,p=window.isMVK?604:537,g=window.isMVK?360:343;function m(t,e,i,a){var n={id:t.id,width:intval(e),height:intval(i),lastColumn:a.lastColumn,lastRow:a.lastRow,single:a.single,image:f(t,e,i,a.single),unsized:t.unsized,type:t.type,orig:t};return t.title&&void 0!==t.size?extend(n,{title:t.title,size:t.size}):t.title&&void 0!==t.msize?extend(n,{title:t.title,msize:t.msize}):t.type===d&&t.name&&void 0!==t.name&&extend(n,{name:t.namem}),"number"==typeof t.duration&&(t.duration=formatTime(t.duration)),n.unsized?n.ratio=1:n.ratio=n.image.width/n.image.height,n}function f(t,e,i,a){if(!t)return{};e=intval(e),i=intval(i);var n,r=window.devicePixelRatio||1;if(t.type===d||t.type===l){(t.vid?["x","y","l","s","m"]:["o","z","y","x","m","s","temp"]).forEach(a=>{t.sizes[a]&&(!n||e*r<=t.sizes[a][1]&&i*r<=t.sizes[a][2])&&(n=t.sizes[a])})}else{var o=t.thumb?t.thumb.sizes:t.sizes,s=o.x||o[o.length-1],h=s?(s[1]||1)/(s[2]||1):1,c=0;h>e/i?(c=i,h>1&&(c*=h)):(c=e,h<1&&(c/=h)),i*=r,e*=r;var u=!a&&o.o,v="";v=o.temp?"temp":c<75?"s":c<130?"m":u&&o.o&&o.o[1]>=e&&o.o[2]>=i?"o":u&&o.p&&o.p[1]>=e&&o.p[2]>=i?"p":u&&o.q&&o.q[1]>=e&&o.q[2]>=i?"q":u&&o.r&&o.r[1]>=e&&o.r[2]>=i?"r":"x",n=o[v]}return n[1]=intval(n[1]),n[2]=intval(n[2]),n[1]&&n[2]||(t.unsized=!0),{src:n[0],width:n[1],height:n[2]}}function w(t,e,i){var a;switch(t.type){case l:a=t.ratio;break;case d:a=t.ratio||1.777;break;case c:case u:a=1.5;break;default:if(t.sizes&&t.sizes.x){var n=o(t.sizes.x,3),r=n[1],s=n[2];r&&s&&(a=r/s)}if(t.sizes&&t.sizes.temp){var h=o(t.sizes.temp,3),v=h[1],p=h[2];v&&p&&(a=v/p)}}return a||1}function b(t){return!!~[l,h,d,c,u].indexOf(t.toString())}function y(t,e){var i=_(t)||void 0===t.length?{}:[];for(var a in t)(!/webkit/i.test(_ua)||"layerX"!=a&&"layerY"!=a&&"webkitMovementX"!=a&&"webkitMovementY"!=a)&&(e&&"object"==typeof t[a]&&"prototype"!==a&&null!==t[a]?i[a]=y(t[a]):i[a]=t[a]);return i}var _=t=>"[object Object]"===Object.prototype.toString.call(t);var x=i("FWc3");function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var i=[],a=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);a=!0);}catch(t){n=!0,r=t}finally{try{a||null==s.return||s.return()}finally{if(n)throw r}}return i}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return M(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return M(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var z={cache:function(){return cur._thEdCache||(cur._thEdCache={}),cur._thEdCache},loaded:function(){return cur._thEdLoaded||(cur._thEdLoaded={}),cur._thEdLoaded},cur:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){return cur._thEdCur||(cur._thEdCur={}),cur._thEdCur})),getMedias:function(t){var e=[];return(t=ge(t))?((this.cache()[t.id]?this.cache()[t.id].previews:[]).forEach(t=>{this.isValidThumbType(t.type)&&e.push([t.type,`${t.ownerId}_${t.itemId}`])}),e):e},init:function(t,e,i){if(t=ge(t)){(i="boolean"==typeof i?{wide:i}:clone(i)||{}).width&&i.height?i.force=!0:(i.width=t.parentNode.offsetWidth,i.height=Math.round(i.width/1.5));var a=[];e.forEach(t=>{this.isValidThumbType(t.type)&&a.push(t)}),domData(t,"te-inited",1),this.cache()[t.id]={previews:a,opts:i,wide:i.wide,height:0,thumbs:[]};var n=this.cur().timer;n&&clearTimeout(n),a.length?this.cur().timer=setTimeout(()=>{var e=this.processThumbs(i.width,i.height,a,i);this.cache()[t.id].thumbs=e.thumbs,this.cache()[t.id].height=e.height;var n=cf();e.thumbs.forEach((t,e)=>{n.appendChild(this.createThumbEl(t,e))}),val(t,""),toggleClass(t,"wide",i.wide),setStyle(t,{width:e.width,height:e.height}),t.appendChild(n),show(t)},0):(hide(t),val(t,""))}},getParentTooltipCls:function(t){return gpeByClass("_im_text_input",t)?"_im_text_input":"thumb_wrap"},loadAndDisplayImage:function(t,e){if(t&&e&&e.oldImage){var i=new Image,a=e.image,n=e.oldImage;if(this.loaded()[a.src]&&t.src!==a.src)return t.src=a.src,void delete e.oldImage;var r=()=>{t.src===n.src&&(t.src=a.src,delete e.oldImage,this.loaded()[a.src]=!0),removeEvent(i,"load",r)};addEvent(i,"load",r),i.src=a.src}},createThumbEl:function(t,e){if(t&&this.isValidThumbType(t.type)){var i,r=t.oldImage||t.image,o=this.crop(t,t.width,t.height),s="draggable_thumb _draggable clear_fix"+(t.unsized?" unsized"+(t.single?" unsized_single":""):""),v=`thumb_wrap fl_l thumb_${t.type}_wrap`;switch(t.lastColumn&&(v+=" last_column"),t.lastRow&&(v+=" last_row"),t.height<50&&(v+=" thumb_no_controls"),t.type){case c:case u:t.image.src.match(/^\/images\//)&&(v+=" page_album_nocover"),(t.title||t.thumb)&&(i=`\n            <div class="page_album_title">\n              <div class="page_album_size">${t.msize||t.size}</div>\n              <div class="page_album_title_text">${t.title}</div>\n            </div>\n          `);break;case h:i=`\n          <div class="photo_thumb_btns_container">\n            <div class="photo_thumb_btns_overlay">\n              <div class="photo_thumb_btns">\n                <div class="photo_thumb_btn_show _photo_thumb_btn_show" id="ui_btn_show"></div>\n                ${Object(a.isPhotoeditor3Available)()&&!vk.widget?'<div class="photo_thumb_btn_editor _photo_thumb_btn_editor" id="ui_btn_pe"></div>':""}\n              </div>\n            </div>\n          </div>\n        `;break;case l:i=`\n          ${t.orig.label}\n          <a href="${t.orig.href}" class="post_doc_thumb_link" target="_blank" rel="noopener"></a>\n        `;break;case d:i=t.orig.preview}var p=t.unsized||t.orig.preview?"":`\n      <img class="preview _preview" src="${clean(r.src)}" width="${Math.round(o.width)}" height="${Math.round(o.height)}" style="margin:${o.marginTop}px 0 0 ${o.marginLeft}px;"/>\n    `,g=`\n      <div index="${e}" attachment="${t.id}" class="${v}"${t.name?` aria-label="${clean(t.name)}"`:""} style="width: ${intval(t.width)}px;height: ${intval(t.height)}px;">\n        <div class="${s}" ${t.unsized?` style="background-image:url(${clean(r.src)})"`:""}>\n          ${p}\n          ${i}\n          ${t.type!==d?'<div class="overlay _overlay"></div>':""}\n          <div class="ui_thumb_x_button _close_btn" role="link" aria-label="${clean(getLang("dont_attach"))}">\n            <div class="ui_thumb_x"></div>\n          </div>\n        </div>\n      </div>\n    `,m=se(g),f=geByClass1("_preview",m),w=geByClass1("_draggable",m),b=geByClass1("_close_btn",m);if(t.oldImage&&f&&this.loadAndDisplayImage(f,t),addEvent(w,"click",t=>{if(this.cur().updating||domClosest("_close_btn",t.target))cancelEvent(t);else{var e=gpeByClass("thumb_wrap",t.target),i=this.cache()[e.parentNode.id].previews[e.getAttribute("index")].click;cur.openEditor=hasClass(t.target,"_photo_thumb_btn_editor"),Object(n.isFunction)(i)&&i(t)}}),addEvent(w,"mousedown touchstart",t=>this.startDrag(t)),addEvent(b,"click",t=>{var e=gpeByClass("thumb_wrap",t.target);hide(geByClass1("_draggable",e)),this.removeMedia(e.parentNode.id,e.getAttribute("index"))}),addEvent(b,"mouseover",()=>Object(x.showTooltip)(b,{text:getLang("dont_attach"),shift:[11,8],black:1})),t.type===h){var y=geByClass1("_photo_thumb_btn_show",m);y&&addEvent(y,"mouseover",()=>Object(x.showTooltip)(y,{text:getLang("global_photo_attach_show"),shift:[10,8],black:1,appendParentCls:this.getParentTooltipCls(w)}));var _=geByClass1("_photo_thumb_btn_editor",m);_&&addEvent(_,"mouseover",()=>Object(x.showTooltip)(_,{text:getLang("global_pe_edit"),shift:[9,8],black:1,appendParentCls:this.getParentTooltipCls(w)}))}return m}},getCoords:function(t,e){var i=[];return e=e||getXY(t),Array.from(t.childNodes).forEach(t=>{if(hasClass(t,"thumb_wrap")){var a=getXY(t);i[i.length]={id:t.getAttribute("attachment"),x:intval(a[0]-e[0]),y:intval(a[1]-e[1]),width:intval(t.offsetWidth),height:intval(t.offsetHeight),index:intval(t.getAttribute("index")),node:t}}}),i},startDrag:function(t){var e=t.touches&&1==t.touches.length,i=null==t.button||0!=t.button&&!(1==t.button&&browser.msie8);if(hasClass(t.target,"_photo_thumb_btn_show")||hasClass(t.target,"_photo_thumb_btn_editor"))return cancelEvent(t);if(!(i&&!e||domClosest("_close_btn",t.target)||this.cur().updating)){var a=gpeByClass("draggable_thumb",t.target),n=gpeByClass("editable_thumbs",a),r=this.cache()[n.id];if(r&&!((r.previews||[]).length<2))return this.cur().el=a,this.cur().dragHandler=t=>this.drag(t),this.cur().dropHandler=t=>this.drop(t),addEvent(window,"mousemove touchmove",this.cur().dragHandler),addEvent(window,"mouseup touchend touchcancel",this.cur().dropHandler),e||cancelEvent(t)}},drag:function(t){var e=this.cur().el;if(t.touches&&t.touches.length>1)return this.drop();var i=browser.android?t.touches[0].pageX+(t.pageX||0):t.pageX,a=browser.android?t.touches[0].pageY+(t.pageY||0):t.pageY,n=this.cur();if(hasClass(e,"moving")){var r=i-(n.pos[0]+n.x),o=a-(n.pos[1]+n.y);setStyle(e,{left:r,top:o});var s=n.wpos,l={x:r=n.pos[0]+intval(e.style.marginLeft)+r-s[0],y:o=n.pos[1]+intval(e.style.marginTop)+o-s[1],offsetX:e.offsetWidth,offsetY:e.offsetHeight,index:n.i,node:e},h=!1,d=n.i,c=-1;each(n.coords,(function(t,e){if(t!=n.i&&t!=c){e.offsetX=e.node.offsetWidth+5,e.offsetY=e.node.offsetHeight+5;var i=n.coords[t-1],a=n.coords[t+1],r=l.x+l.offsetX/2,o=l.y+l.offsetY/2,s=e.x+e.offsetX/2,u=e.y+e.offsetY/2,v=e.x+e.offsetX,p=e.y+e.offsetY,g=(i&&i.x==e.x&&i.y!=e.y&&0!=e.y||a&&a.x==e.x&&a.y!=e.y)&&0!=e.x,m=r>=s&&(a&&(r<=a.x+a.offsetX/2&&(a.offsetY==e.offsetY||r<v)||a.y!=e.y)||!a&&l.x<=v)&&o>e.y&&o<p,f=r<s&&r>=e.x&&(!i||i.y!=e.y&&!(i.x==e.x&&!a))&&o>e.y&&o<p,w=g&&o>=u&&o<p&&r>e.x&&r<v,b=g&&o<u&&o>=e.y&&r>e.x&&r<v;m=m&&!g,f=f&&!g&&!m,(m||f||w||b)&&(h=!0,d=e.index<n.i&&(m||w)?e.index+1:l.index<e.index&&(b||f)?e.index-1:e.index),d!=n.i?setStyle(e.node,{left:m?-2:f?2:0,top:w?-2:b?2:0}):setStyle(e.node,{left:0,top:0}),m&&a&&a.y==e.y&&a.x>e.x&&l.index>e.index&&(setStyle(e.node,{left:0,top:0}),setStyle(a.node,{left:2,top:0}),c=t+1),w&&a&&a.x==e.x&&a.y>e.y&&o<=u&&(setStyle(a.node,{left:0,top:0}),c=t+1),b&&i&&i.x==e.x&&i.y<e.y&&o<=u&&(setStyle(i.node,{left:0,top:-2}),setStyle(e.node,{left:0,top:0}))}})),n.to_i=h?d:n.i}else{var u=e.parentNode.parentNode,p=geByClass1("_overlay",e),g=geByClass1("_preview",e),m=intval(e.parentNode.getAttribute("index")),f=this.cache()[u.id].thumbs[m],w=getXY(u),b=getXY(e.parentNode),y=this.getCoords(u,w);n.id=u.id,n.i=m,n.to_i=m,n.x=i-b[0],n.y=a-b[1],n.t=f,n.w=f.width,n.h=f.height,n.pos=b,n.wpos=w,n.crop=this.crop(f,f.width,f.height),n.coords=y;var _=C(this.scale(f.width,f.height,75),2),x=_[0],M=_[1],z=intval((f.width-x)*(browser.mobile?.5:n.x/f.width)),E=intval((f.height-M)*(browser.mobile?.5:n.y/f.height));addClass(e,"moving"),setStyle(e,"zIndex",100);var T={duration:v,transition:Fx.Transitions.easeOutCubic},k=this.crop(f,x,M);animate(e,{opacity:.85,width:x,height:M,marginLeft:z,marginTop:E},T),animate(p,{opacity:1},T),g&&animate(g,k,T)}return cancelEvent(t)},drop:function(t){var e=this.cur();document.removeEventListener("touchmove",this.preventScroll),e.updating=!0;var i=e.el,a=geByClass1("_overlay",i),r=geByClass1("_preview",i);if(removeEvent(window,"mousemove touchmove",e.dragHandler),removeEvent(window,"mouseup touchend touchcancel",e.dropHandler),!hasClass(i,"moving"))return e.updating=!1,cancelEvent(t);if(e.to_i==e.i){var o=e.crop,s={duration:v,transition:Fx.Transitions.easeOutCubic};animate(i,{marginTop:0,marginLeft:0,top:0,left:0,width:e.w,height:e.h,opacity:1},extend(s,{onComplete:()=>{setStyle(i,"zIndex",null),e.updating=!1}})),animate(a,{opacity:0},s),r&&animate(r,o,s)}else{var l=this.cache()[e.id].previews;l=this.move(l,e.i,e.to_i),this.update(e.id,l),Object(n.isFunction)((this.cache()[e.id].opts||{}).onMove)&&this.cache()[e.id].opts.onMove()}return removeClass(i,"moving"),cancelEvent(t)},update:function(t,e){if(t=ge(t)){var i=t.id,a=ge(i),r=this.cache()[a.id],o=r.thumbs,s=r.height,l=r.opts,h=!0===l||!1===l?{wide:l}:clone(l||{}),d=h.width,c=h.height;d&&c?h.force=!0:(d=t.parentNode.offsetWidth,c=Math.round(d/1.5));var u=this.processThumbs(d,c,e,h),p=se(`\n      <div style="height: 0;overflow: hidden;">\n        <div class="_editable_thumbs editable_thumbs${r.wide?" wide":""}" style="width: ${u.width}px;height: ${u.height}px;"></div>\n      </div>\n    `),g=geByClass1("_editable_thumbs",p);u.thumbs.forEach((t,e)=>{g.appendChild(this.createThumbEl(t,e))}),a.parentNode.appendChild(p);var m=this.getCoords(g);each(m,(t,e)=>{for(var i=null,a=this.cur().coords,n=0,r=a.length;n<r;++n)if(a[n].id==e.id){i=a[n];break}if(null!=i){var s=geByClass1("_draggable",i.node),l=geByClass1("_overlay",s),h=geByClass1("_preview",s),d=o[i.index],c=null;each(u.thumbs,(t,e)=>{e.id==d.id&&(this.loaded()[e.image.src]||(e.oldImage=d.image),c=e)}),setStyle(i.node,{left:0,top:0}),i.height==e.height&&i.width==i.width&&e.x==i.x&&e.y==i.y&&i.index!=this.cur().i||(hasClass(s,"moving")&&fadeOut(l,v),setTimeout(()=>{animate(s,{top:e.y-i.y,left:e.x-i.x,marginLeft:0,marginTop:0,height:e.height,width:e.width,opacity:1},v);var t=this.crop(c,e.width,e.height);h&&animate(h,t,v),toggleClass(s,"unsized_single",c.unsized&&c.single)},4))}}),s!=u.height&&setTimeout(()=>{animate(a,{height:u.height},v)},4),setTimeout(()=>{Object(n.isFunction)(h.onUpdate)&&h.onUpdate(),setStyle(a,{height:u.height,width:u.width}),a.innerHTML="",this.cache()[i].thumbs=u.thumbs,this.cache()[i].previews=e,this.cache()[i].height=u.height,u.thumbs.forEach((t,e)=>{a.appendChild(this.createThumbEl(t,e))}),re(p),this.cur().updating=!1},v)}},setWide:function(t,e,i){if(t=ge(t)){var a=this.cache()[t.id],n=clone(i||{});void 0===e&&(e=!1),n.wide=e,a.wide!=e&&this.init(t,a.previews,n)}},hasMedia:function(t,e){if(t=ge(t)){var i=t.id,a=this.cache()[i];if(a){for(var n=0;n<a.previews.length;n++)if(a.previews[n][a.previews[n].type].id==e)return!0;return!1}}},addMedia:function(t,e){if((t=ge(t))&&e){var i=t.id,a=this.cache()[i];if(a){var n=clone(a.previews);10==n.length||this.hasMedia(t,e[e.type].id)||(n[n.length]=e,this.cache()[i]=null,this.init(i,n,clone(a.opts)))}}},updateMedia:function(t,e,i,a){if((t=ge(t))&&e&&i&&a){var n=t.id,r=this.cache()[n];if(r){for(var o=clone(r.previews),s=!1,l=e+i,h=0;h<o.length;h++)if(o[h][o[h].type].id==l){var d=this.convert(e,i,a.editable);o[h]=d,s=!0;break}s&&(this.cache()[n]=null,this.init(n,o,clone(r.opts)))}}},refresh:function(t){if(t=ge(t)){var e=t.id,i=this.cache()[e];i&&(this.cache()[e]=null,this.init(e,clone(i.previews),clone(i.opts)))}},removeAll:function(t){if(t=ge(t)){var e=t.id,i=this.cache()[e];i&&(this.cache()[e]=null,this.init(e,[],i.opts))}},removeMedia:function(t,e){if(!(t=ge(t)))return null;e=intval(e);var i=this.cache()[t.id];if(i){var a=i.previews.splice(e,1),n=a[0][a[0].type].id;return each(t.childNodes,(t,e)=>{if(e.getAttribute&&e.getAttribute("attachment")==n){var i=(geByClass1("_close_btn",e)||{}).tt;i&&i.destroy&&i.destroy()}}),this.cur().coords=this.getCoords(t),0==i.previews.length?this.init(t,[],i.opts):this.update(t,i.previews),a[0]&&a[0].remove&&a[0].remove(),a}},removeById:function(t,e){if(!(t=ge(t)))return null;for(var i=(this.cache()[t.id]||{}).previews||[],a=0,n=i.length;a<n;++a)if(i[a].type==l&&i[a].doc.id==e||i[a].type==h&&i[a].photo.id==e||i[a].type==d&&i[a].video.id==e||i[a].type==c&&i[a].album.id==e||i[a].type==u&&i[a].market_album.id==e)return this.removeMedia(t,a);return null},processThumbs:function(t,e,i,a){var n=function(t){var e=0;return each(t,(t,i)=>{e+=i}),e},r=function(t,e,i){return(e-(t.length-1)*i)/n(t)},o=(a=_(a)?a:{}).wide,s=[],l=0,h=[],c=[];each(i,(t,e)=>{b(e.type)&&(h[h.length]=e[e.type]),e.type===d&&s.push(l),l++});var u="",v=[],f=h.length;each(h,(i,a)=>{var n=w(a,t,e);u+=n>1.2?"w":n<.8?"v":"q",v[v.length]=n});var x,C,M=v.length>0?n(v)/v.length:1,z=5;window.isMVK&&(z=window.innerWidth>=480?6:3);var E=z;a.force?(x=t,C=e):(o?(x=p,C=g):t>=381?(x=381,C=1==f?361:237):(x=337,C=1==f?320:214),t<x&&(x=t,C=e),window.isMVK&&(x=Math.min(p,window.innerWidth),C=Math.min(g,x)));var T=x/C,k=0,S=0;if(1==f){var $={lastColumn:1,lastRow:1,single:1};h[0].thumb?(k=279,S=185):v[0]>=1*T?(k=x,S=Math.min(k/v[0],C)):(S=C,k=Math.min(S*v[0],x));var O=m(h[0],k,S,$);!O.unsized&&(O.image.width<k&&O.image.height<=C||O.image.height<S&&O.image.width<=x)&&(k=O.image.width,S=O.image.height,O=m(h[0],k,S,$)),c[0]=O}else if(2==f){var j,I;switch(u){case"ww":if(M>1.4*T&&v[1]-v[0]<.2){I=x,j=Math.min(I/v[0],I/v[1],(C-E)/2),c[0]=m(h[0],I,j,{lastColumn:1}),c[1]=m(h[1],I,j,{lastColumn:1,lastRow:1}),k=x,S=2*j+E;break}case"vv":case"qv":case"vq":case"qq":I=(x-z)/2,j=Math.min(I/v[0],I/v[1],C),c[0]=m(h[0],I,j,{lastRow:1}),c[1]=m(h[1],I,j,{lastRow:1,lastColumn:1}),k=x,S=j;break;default:var A=intval((x-z)/v[1]/(1/v[0]+1/v[1])),R=x-A-z;j=Math.min(C,A/v[0],R/v[1]),c[0]=m(h[0],A,j,{lastRow:1}),c[1]=m(h[1],R,j,{lastColumn:1,lastRow:1}),k=x,S=j}}else if(3==f)if((v[0]>1.2*T||M>1.5*T)&&"www"==u){var B,P=x,X=Math.min(P/v[0],.66*(C-E));if(c[0]=m(h[0],P,X,{lastColumn:1}),"www"==u){var Y=intval(x-z)/2;B=Math.min(C-X-E,Y/v[1],Y/v[2]),c[1]=m(h[1],Y,B,{lastRow:1}),c[2]=m(h[2],x-Y-z,B,{lastColumn:1,lastRow:1})}else{var L=intval((x-z)/v[2]/(1/v[1]+1/v[2])),H=x-L-z;B=Math.min(C-X-E,L/v[2],H/v[1]),c[1]=m(h[1],L,B,{lastRow:1}),c[2]=m(h[2],L,B,{lastRow:1,lastColumn:1})}k=x,S=X+B+E}else{var N=C,V=intval(Math.min(N*v[0],.75*(x-z)));c[0]=m(h[0],V,N,{lastRow:1});var q=v[1]*(C-E)/(v[2]+v[1]),K=C-q-E,W=Math.min(x-V-z,intval(q*v[2]),intval(K*v[1]));c[1]=m(h[1],W,K,{lastColumn:1}),c[2]=m(h[2],W,q,{lastColumn:1,lastRow:1}),k=V+W+z,S=C}else if(4==f)if((v[0]>1.2*T||M>1.5*T)&&"wwww"==u){var D=x,U=Math.min(D/v[0],.66*(C-E));c[0]=m(h[0],D,U,{lastColumn:1});var F=(x-2*z)/(v[1]+v[2]+v[3]),G=intval(F*v[1]),J=intval(F*v[2]),Q=D-G-J-2*z;F=Math.min(C-U-E,F),c[1]=m(h[1],G,F,{lastRow:1}),c[2]=m(h[2],J,F,{lastRow:1}),c[3]=m(h[3],Q,F,{lastColumn:1,lastRow:1}),k=x,S=U+F+E}else{var Z=C,tt=Math.min(Z*v[0],.66*(x-z)),et=(C-2*E)/(1/v[1]+1/v[2]+1/v[3]),it=intval(et/v[1]),at=intval(et/v[2]),nt=Z-it-at-2*E;tt+(et=Math.min(x-tt-z,et))+z<x&&Z*v[0]>tt&&(tt=Math.min(Z*v[0],x-z-et)),c[0]=m(h[0],tt,Z,{lastRow:1}),c[1]=m(h[1],et,it,{lastColumn:1}),c[2]=m(h[2],et,at,{lastColumn:1}),c[3]=m(h[3],et,nt,{lastColumn:1,lastRow:1}),k=tt+et+z,S=C}else{var rt=[],ot=0;M>(s.length?1.3:1.1)?each(v,(t,e)=>{rt[rt.length]=Math.max(1,e)}):each(v,(t,e)=>{~s.indexOf(ot)?rt[rt.length]=e:rt[rt.length]=Math.min(1,e),ot++});var st,lt,ht={};for(ht[f+""]=[r(rt,x,z)],st=1;st<=f-1;st++)ht[st+","+(lt=f-st)]=[r(rt.slice(0,st),x,z),r(rt.slice(st),x,z)];for(st=1;st<=f-2;st++)for(lt=1;lt<=f-st-1;lt++)ht[st+","+lt+","+(f-st-lt)]=[r(rt.slice(0,st),x,z),r(rt.slice(st,st+lt),x,z),r(rt.slice(st+lt),x,z)];var dt,ct=null,ut=0;for(var vt in ht)if(ht.hasOwnProperty(vt)){var pt=ht[vt],gt=n(pt)+E*(pt.length-1),mt=Math.abs(gt-C);if(~vt.indexOf(",")){for(var ft=vt.split(","),wt=0;wt<ft.length;wt++)ft[wt]=intval(ft[wt]);(ft[0]>ft[1]||ft[2]&&ft[1]>ft[2])&&(mt+=50,mt*=1.5)}(null===ct||mt<ut)&&(ct=vt,ut=mt,dt=gt)}for(var bt=y(h),yt=y(rt),_t=ct.split(","),xt=ht[ct],Ct=_t.length-1,Mt=0;Mt<_t.length;Mt++){var zt=parseInt(_t[Mt]),Et=bt.splice(0,zt),Tt=xt.shift(),kt=Et.length-1,St={};Ct==Mt&&(St.lastRow=!0);for(var $t=x,Ot=0;Ot<Et.length;Ot++){var jt=Et[Ot],It=yt.shift(),At=St,Rt=void 0;kt==Ot?(Rt=Math.ceil($t),At.lastColumn=!0):$t-=(Rt=intval(It*Tt))+z,c[c.length]=m(jt,Rt,Tt,At)}}k=x,S=dt}return{width:intval(k),height:intval(S),thumbs:c}},compute:m,getSize:f,move:function(t,e,i){if(i>=t.length)for(var a=i-t.length;1+a--;)t.push(void 0);return t.splice(i,0,t.splice(e,1)[0]),t},scale:function(t,e,i,a){i=intval(i),a=intval(a)||i;var n=t,r=e;return t>=e&&t>i?(n=intval(i),r=intval(e/(t/i))):t<e&&e>a&&(r=intval(a),n=intval(t/(e/a))),[n,r]},crop:function(t,e,i){var a=e,n=i,r=0,o=0;if(!t.vid&&t.image.width&&t.image.height){var s=t.image.width/t.image.height;s<e/i?(t.single&&t.image.width<e&&(e=t.image.width,i=Math.min(i,t.image.height)),(n=(a=e)/s)>i&&(o=-intval((n-i)/2))):(t.single&&t.image.height<i&&(i=t.image.height,e=Math.min(e,t.image.width)),(a=(n=i)*s)>e&&(r=-intval((a-e)/2)))}return{width:a,height:n,marginLeft:r,marginTop:t.orig&&(t.type===u||t.type===c)&&t.single?0:o}},getRatio:w,convert:function(t,e,i,a){var n=o(e.split("_"),2),s=n[0],v=n[1],p=r({owner_id:s,ownerId:s,itemId:v,type:t,remove:i.remove,click:i.click,temp:"temp"in i.sizes},a);switch(t){case l:p.data={sizes:i.sizes,ratio:i.ratio,label:i.label,href:i.href},p.doc=p.data;break;case h:p.data={pid:v,sizes:i.sizes},p.photo=p.data;break;case d:p.data={vid:v,duration:i.duration,platform:i.platform,play_icon:i.play_icon,preview:i.preview,active_live:i.active_live,restriction:i.restriction,ratio:i.ratio,sizes:i.sizes,name:i.name},p.video=p.data;break;case c:p.data={aid:v,title:i.title,size:i.size,thumb:{sizes:i.sizes}},p.album=p.data;break;case u:p.data={type:u,aid:v,title:i.title,msize:i.msize,thumb:{sizes:i.sizes}},p.market_album=p.data}return p.data.type=t,p.data.id=p.temp?`${t}temp_${s}`:`${t}${p.ownerId}_${p.itemId}`,p},isValidThumbType:b};window.ThumbsEdit=z;try{window.stManager.done(window.jsc("web/thumbs_edit.js"))}catch(t){}}});